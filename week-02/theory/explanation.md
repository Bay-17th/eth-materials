# 2주차: 트랜잭션과 서명 - 쉬운 설명

> 이 문서는 슬라이드의 내용을 **초보자도 이해할 수 있도록** 풀어서 설명합니다.

## 목차

1. [서론 - 은행 송금 비유](#서론---은행-송금-비유)
2. [트랜잭션의 구성 요소](#트랜잭션의-구성-요소)
3. [디지털 서명이란?](#디지털-서명이란)
4. [ECDSA와 키 페어](#ecdsa와-키-페어)
5. [트랜잭션의 여정](#트랜잭션의-여정)
6. [보안 주의사항](#보안-주의사항)
7. [핵심 요약](#핵심-요약)

---

## 서론 - 은행 송금 비유

### 트랜잭션 = 송금 지시서

은행에서 돈을 보낼 때 **송금 지시서**를 작성해본 적 있으신가요?

송금 지시서에는 다음 정보가 필요합니다:
- 누가 보내는지 (보내는 사람)
- 누구에게 보내는지 (받는 사람)
- 얼마를 보내는지 (금액)
- 수수료는 얼마인지 (이체 수수료)

**이더리움의 트랜잭션도 똑같습니다!**

다만 차이점이 있어요:
- 은행 송금: 은행이 대신 처리해줌
- 이더리움: 직접 **서명**해서 네트워크에 보냄

### 서명 = 본인 도장

은행 송금 지시서에 **도장이나 서명**이 필요하듯이,
이더리움 트랜잭션에도 **디지털 서명**이 필요합니다.

이 서명이 "이 트랜잭션은 정말 내가 보낸 것"임을 증명합니다.

---

## 트랜잭션의 구성 요소

### 트랜잭션에 담기는 정보

| 필드 | 한글명 | 비유 | 설명 |
|------|--------|------|------|
| from | 보내는 주소 | 보내는 사람 계좌 | 트랜잭션을 보내는 계정 |
| to | 받는 주소 | 받는 사람 계좌 | ETH나 메시지를 받을 계정 |
| value | 전송량 | 송금 금액 | 보내는 ETH 양 (Wei 단위) |
| nonce | 순서 번호 | 대기 번호표 | 이 계정의 몇 번째 트랜잭션인지 |
| gasLimit | 가스 한도 | 주유 예산 | 최대 사용할 가스량 |
| gasPrice | 가스 가격 | 리터당 가격 | 가스 1단위의 가격 |
| data | 데이터 | 부가 메시지 | 컨트랙트 호출 시 필요한 정보 |

### nonce가 왜 필요할까요?

상상해보세요. 당신이 친구에게 1 ETH를 보내는 트랜잭션을 만들었습니다.
악의적인 누군가가 이 트랜잭션을 **복사해서 100번 재전송**하면 어떻게 될까요?

**nonce가 없다면:** 100 ETH가 빠져나갑니다!

**nonce가 있다면:** 같은 nonce를 가진 트랜잭션은 **한 번만** 처리됩니다.

```
nonce = 5인 트랜잭션 -> 처리됨
nonce = 5인 트랜잭션 (복사본) -> 거부됨 (이미 5번은 처리됨)
nonce = 6인 트랜잭션 -> 처리됨
```

이렇게 nonce는 **재사용 공격(Replay Attack)**을 막아줍니다.

---

## 디지털 서명이란?

### 복제 불가능한 도장

일반 도장의 문제점을 아시나요?
- 누군가 도장을 훔쳐가거나
- 모양을 복제하면
- 내 것인 척 할 수 있습니다

**디지털 서명**은 다릅니다:
- 같은 메시지에 대해 **나만** 만들 수 있는 고유한 서명
- **복제 불가능** (수학적으로 증명됨)
- 메시지가 바뀌면 서명도 **완전히 달라짐**

### Private Key = 내 도장

**Private Key(개인키)**는 당신만의 비밀 열쇠입니다.
- 이 키로 서명을 만들 수 있습니다
- 이 키가 있으면 **모든 권한**을 가집니다

### Public Key = 도장 확인 방법

**Public Key(공개키)**는 누구나 볼 수 있습니다.
- 서명이 진짜인지 **확인**하는 데 사용
- 공개키를 알아도 개인키는 **알 수 없음**

### 비유로 정리

| 현실 세계 | 이더리움 |
|-----------|----------|
| 도장 | Private Key |
| 도장 감정사 | Public Key |
| 날인된 문서 | 서명된 트랜잭션 |
| 위조 확인 | 서명 검증 |

---

## ECDSA와 키 페어

### ECDSA가 뭔가요?

**ECDSA** = Elliptic Curve Digital Signature Algorithm

어렵게 들리지만, 단순히:
> "타원 곡선을 이용한 디지털 서명 알고리즘"

이더리움과 비트코인 모두 이 알고리즘을 사용합니다.

### 키 생성 과정

```
1. 랜덤 숫자 생성 -> Private Key (256비트)
2. 수학적 계산 -> Public Key
3. 해시 계산 -> Address (0x로 시작하는 주소)
```

**중요한 점:**
- Private Key -> Public Key: **가능** (쉬움)
- Public Key -> Private Key: **불가능** (수학적으로 사실상 불가능)

### 주소(Address)란?

주소는 Public Key를 **해시**해서 만든 짧은 식별자입니다.

```
Public Key: 매우 긴 숫자 (64바이트)
         ↓ Keccak256 해시 + 하위 20바이트
Address: 0x71C7656EC7ab88b098defB751B7401B5f6d8976F (20바이트)
```

이 주소가 여러분의 **계좌번호**가 됩니다.

---

## 트랜잭션의 여정

### 트랜잭션이 처리되기까지

1. **생성 (Create)**
   - 지갑에서 받는 주소, 금액 등을 입력
   - 트랜잭션 데이터 구성

2. **서명 (Sign)**
   - Private Key로 트랜잭션에 서명
   - 이 서명이 "내가 보낸 것"을 증명

3. **전파 (Broadcast)**
   - 서명된 트랜잭션을 네트워크에 전송
   - 수천 개의 노드에 퍼져나감

4. **대기 (Mempool)**
   - 아직 블록에 포함되지 않은 상태
   - Gas Price가 높을수록 먼저 선택됨

5. **검증 (Verify)**
   - 노드들이 서명이 올바른지 확인
   - nonce가 맞는지 확인
   - 잔액이 충분한지 확인

6. **포함 (Include)**
   - 블록에 포함되면 **확정**
   - 이제 되돌릴 수 없음!

### Gas와 우선순위

**Gas**는 트랜잭션 처리 비용입니다.

```
총 비용 = Gas Used x Gas Price
```

Gas Price를 높이면:
- 채굴자(검증자)가 먼저 처리해줌
- 빠른 처리 = 높은 비용

Gas Price를 낮추면:
- 처리가 느려짐
- 너무 낮으면 영원히 처리 안 될 수도

> 택시 할증 요금과 비슷해요. 더 내면 더 빨리 갑니다!

---

## 보안 주의사항

### Private Key는 절대 공유 금지

이 부분은 정말 중요합니다. **생명처럼** 지키세요.

**Private Key가 노출되면:**
- 모든 ETH와 토큰이 **즉시** 도난당할 수 있음
- **되돌릴 방법이 없음** (블록체인은 영구적)
- 은행처럼 취소나 환불 **불가능**

### 실제 피해 사례

**Ronin Bridge 해킹 (2022년)**
- 피해액: $625M (약 8,000억원)
- 원인: Private Key 5개가 탈취됨
- 방법: 사회공학 공격 (가짜 채용 제안 링크)

**개인 피해 사례들:**
- "지갑 복구 도와드립니다" 사기 -> Seed Phrase 탈취
- 가짜 에어드롭 사이트 -> Private Key 입력 유도
- 악성 코드 감염 -> 클립보드 주소 변조

### 안전하게 보관하는 방법

**하지 마세요:**
- 스크린샷으로 저장
- 클라우드에 저장 (iCloud, Google Drive)
- 메신저로 전송 (카카오톡, 텔레그램)
- 이메일로 전송
- 누구에게도 알려주기

**이렇게 하세요:**
- 종이에 적어서 안전한 곳에 보관
- Hardware Wallet 사용 (Ledger, Trezor)
- 여러 개로 분산 보관 (금고 + 가족에게)
- Multi-sig 지갑 사용 (여러 키 필요)

### 더 알아보기

보안에 대해 더 자세히 알고 싶다면:
- [OWASP SCSTG](https://github.com/OWASP/owasp-scstg) - 스마트 컨트랙트 보안 테스트 가이드
- [용어 사전](../../resources/glossary.md) - 보안 관련 용어 정리

---

## 핵심 요약

### 이번 주에 배운 것

1. **트랜잭션**
   - 이더리움의 "송금 지시서"
   - from, to, value, nonce, gas 등의 필드로 구성
   - nonce로 재사용 공격 방지

2. **디지털 서명**
   - Private Key로 만드는 "복제 불가능한 도장"
   - 본인 확인, 위변조 방지, 부인 방지

3. **키 페어**
   - Private Key -> Public Key -> Address (단방향)
   - Private Key는 **절대 비밀**, 분실 시 복구 불가

4. **보안**
   - Private Key 노출 = 모든 자산 탈취
   - Hardware Wallet, Multi-sig로 보호

### 다음 단계

**3주차 예고: EVM과 스마트컨트랙트**
- EVM이 어떻게 코드를 실행하나요?
- Storage, Memory, Stack의 차이는?
- 보안: Reentrancy 공격이란?

**복습 질문:**
1. nonce는 왜 필요한가요?
2. Private Key와 Public Key의 차이는?
3. 트랜잭션이 확정되려면 어떤 과정을 거치나요?

---

*다음: [3주차 - EVM과 스마트컨트랙트](../../week-03/theory/explanation.md)*
*용어가 어려우면: [용어 사전](../../resources/glossary.md)*
